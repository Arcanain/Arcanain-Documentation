# Sensing requirement

## Abstract
本ページでは、Sensingに関する要求仕様を記載する。

## GNSS Requirement
GNSSに関する要求仕様を以下に記載する。

| 要求 | GNSS-01 | GNSSセンサから取得されるデータ形式（nmea_msgs/Sentence）をnmea_navsat_driverを用いて緯度・経度・高度のデータ形式（sensor_msgs/NavSatFix）に変換する |
|:---|:---|:---|
|    | **理由** | 扱いやすいデータ構造へ変換し後段に構える処理を実行するため |
|    | **説明** |  |
| **要求** | **GNSS-02** | **緯度・経度・高度を取得し、ECEU座標系及びENU座標系へ変換する** |
|    | **理由** | ローカル座標系（任意の緯度・経度・高度の原点からの座標値）での移動体の位置情報を取得するため |
|    | **説明** | ECEF(Earth-Centered, Earth-Fixed)座標系への変換には、空間直交座標変換(Geodetic to ECEF Coordinates Transformation)という計算式が用いられます。  以下の式を用いて、緯度・経度・高度からECEF座標へ変換することができます。X = (N + h) * cos(φ) * cos(λ)  Y = (N + h) * cos(φ) * sin(λ)  Z = (N * (1 - e^2) + h) * sin(φ) https://github.com/Arcanain/arcanain-documentation/issues/1 |
|    |　　| < 緯度・経度・高度からECEU座標系へ変換 > |
|    | **GNSS-02.1** | 原点の緯度・経度を定める |
|    | **GNSS-02.2** | 対象の緯度・経度を逐次的に取得する |
|    | **GNSS-02.3** | 測地座標値である緯度・経度を標準極座標値を求める |
|    | **GNSS-02.4** | 測地学に基づき標準極座標値をECEU座標値を求める |
|    |    | < ECEU座標系からECU座標系へ変換 >  |
|    | **GNSS-02.5** | 原点と対象のECEU座標値の差分ベクトルを求める |
|    | **GNSS-02.6** | 原点の緯度・経度からECUE座標からECU座標への変換行列を求める |
|    | **GNSS-02.7** | 変換行列と差分ベクトルを掛けてENU座標ベクトルを求める |
| **要求** | **GNSS-03** | **緯度・経度の分散を取得し、外れ値を除去する** |
|    | **理由** | 外れ値を事前に除去することで後段に構える自己位置推定の性能担保をするため |
|    | **説明** | 閾値は性能担保できる範囲で適合できることとする |
|    | **GNSS-03.1** | 緯度・経度の分散を取得する |
|    | **GNSS-03.2** | 分散と事前に定めた外れ値閾値から、外れ値除去判定を行う |
|    | **GNSS-03.3** | 外れ値と判断された場合、取得した緯度・経度をクリアにする |
|    | **GNSS-03.4** | 外れ値と判断されなかった場合、取得した緯度・経度を用いる |

## IMU Requirement

## Camera Requirement

## Lidar Requirement